<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<style type=text/css>body{font-family:monospace;}</style>
	<title>getopts in Bash</title>
	
	
	<link rel="stylesheet" href="/css/style.css">
	
	
</head>
<body>
	<header>
	================<br>
	== <a href="https://junyubian.github.io/">Junyu Bian</a> ==<br>
	================
	<div style="float: right;">Notes of Junyu.</div><br>
	<p>
	<nav>
			<a href="/"><b>Start</b></a>.
			
			
			<a href="/posts/"><b>Posts</b></a>.
			
			<a href="/categories/"><b>Categories</b></a>.
			
			<a href="/tags/"><b>Tags</b></a>.
			
	</nav>
	</p>
	
</header>

	
	<main>
		<article>
			<h1>getopts in Bash</h1>
			<b><time>10/21/2022 14:17</time></b>
		       
		           <a href="/tags/bash">Bash</a>
        	       

			<div>
				<h1 id="1-notice">1. Notice</h1>
<p>1.1 <code>getopts</code> is different from <code>getopt</code>.
1.2 <code>getopts</code> runs on any system running bash in POSIX mode (e.g., set -o posix), <code>getopt</code> is a system tool varies in different systems.
1.3 <code>getopts</code> parses short options, which are a single dash (&quot;-&quot;) and a letter or digit.e.g. -2, -d, and -D. It can also parse short options in combination, for instance -2dD. But each option will be treated seperately, i.e. -2dD = -2 -d -D not equal -&ldquo;2dD&rdquo;, will need <code>getopt</code> to cope with -&ldquo;2dD&rdquo;.</p>
<h1 id="2-syntax">2. Syntax</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>getopts optstring optname <span style="color:#f92672">[</span> arg <span style="color:#f92672">]</span>
</span></span></code></pre></div><p>2.1 Every time you run <code>getopts</code>, it looks for one of the options defined in <code>optstring</code>. If it finds one, it places the option letter in a variable named <code>optname</code>. If the option does not match those defined in <code>optstring</code>, <code>getopts</code> sets variable <code>optname</code> to a question mark (&quot;?&quot;), will need <code>\?</code> in <code>switch ... case</code>.</p>
<p>2.2 If the option is expecting an argument, <code>getopts</code> gets that argument, and places it in <code>$OPTARG</code>. If an expected argument is not found, the variable optname is set to a colon ( &ldquo;:&rdquo; ). <code>Getopts</code> then increments the positional index, <code>$OPTIND</code>, that indicates the next option to be processed, don&rsquo;t need <code>\:</code> in <code>switch ... case</code>.</p>
<p>2.3 However, if you put a colon at the beginning of the <code>optstring</code>, <code>getopts</code> runs in &ldquo;silent error checking mode.&rdquo; It will not report any verbose errors about options or arguments, and you need to perform error checking in your script.</p>
<p>2.4 In silent mode, if an option is unexpected, getopts sets <code>optname</code> to &ldquo;?&rdquo; and <code>$OPTARG</code> to the unknown option character.</p>
<p>2.5 If the option is OK but an expected argument is not found, <code>optname</code> is set to a colon ( &ldquo;:&rdquo; ) and <code>$OPTARG</code> is set to the unknown option character.</p>
<p>2.6 <code>\?</code> needs to appear before <code>:</code> in <code>switch ... case</code> for error checking, e.g.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> getopts <span style="color:#e6db74">&#34;:hi:&#34;</span> option; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span>$option<span style="color:#e6db74">&#34;</span> in
</span></span><span style="display:flex;"><span>    h<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;help function&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>    i<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>      ilist<span style="color:#f92672">=</span>$OPTARG
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">\?</span><span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>      echo $option
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;Invalid option&#34;</span>
</span></span><span style="display:flex;"><span>      ;;
</span></span><span style="display:flex;"><span>    :<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>      echo $option
</span></span><span style="display:flex;"><span>      echo <span style="color:#e6db74">&#34;no argument&#34;</span>
</span></span><span style="display:flex;"><span>      ;;  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">esac</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div><p>2.7 The special option of two dashes (&quot;&ndash;&quot;) is interpreted by getopts as the end of options.</p>
<h1 id="3-references">3. Reference(s)</h1>
<p>“Bash Getopts Builtin Command Help and Examples.” Help and Examples, 1 Feb. 2021, <a href="https://www.computerhope.com/unix/bash/getopts.htm">https://www.computerhope.com/unix/bash/getopts.htm</a>.</p>
			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/2023-12-03-hello-world/">Hello World</a></li>
				
				<li><a href="/posts/2023-11-07-fluent-bit-notes/">Fluent Bit Client Notes</a></li>
				
				<li><a href="/posts/2022-10-21-dev-null-and-21/">/dev/null and 2&amp;&gt;1</a></li>
				
				<li><a href="/posts/2022-10-21-getopts-in-bash/">getopts in Bash</a></li>
				
				<li><a href="/posts/2021-06-05-k8s-and-docker-related-notes/">K8s and docker Related Notes</a></li>
				
			</ul>
		</div>
	</div>
</aside>


	<footer>
	<p>&copy; 2023 <a href="https://junyubian.github.io/"><b>Junyu Bian</b></a>.
	<a href="https://github.com/junyubian"><b>Github</b></a>.
	<a href="https://twitter.com/junyu_bian"><b>Twitter(X)</b></a>.
	<a href="https://www.facebook.com/profile.php?id=100010301021817"><b>Facebook</b></a>.
	<a href="mailto:junyu.bian@qq.com"><b>Mail</b></a>.
	</p>
</footer>

</body>
</html>
